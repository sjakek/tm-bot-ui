run = "npm install && npm run build && npm start"
hidden = [".config", "package-lock.json", ".next", "node_modules"]
modules = ["nodejs-20"]

[languages]

[languages.javascript]
pattern = "**/{*.js,*.jsx,*.ts,*.tsx,*.json}"

[languages.javascript.languageServer]
start = "typescript-language-server --stdio"

[env]
NODE_ENV = "production"
PORT = "3000"

[deployment]
run = "npm start"
build = "npm run build"
ignorePorts = false
healthCheckPath = "/api/health"
deploymentTarget = "cloudrun"

[deployment.health]
path = "/api/health"
timeoutSeconds = 30
periodSeconds = 10

[[ports]]
localPort = 3000
externalPort = 80

[nix]
packages = ["nodejs-20", "npm"]